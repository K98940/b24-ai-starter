#!/bin/bash

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

print_success() {
    echo -e "${GREEN}‚úì $1${NC}"
}

print_warning() {
    echo -e "${YELLOW}‚ö† $1${NC}"
}

print_error() {
    echo -e "${RED}‚úó $1${NC}"
}

echo "üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å PHP –±—ç–∫–µ–Ω–¥–æ–º"
echo "======================================"

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
print_warning "–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã..."
docker-compose down 2>/dev/null || true

# –£–¥–∞–ª—è–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã
print_warning "–û—á–∏—â–∞–µ–º vendor –∏ composer.lock..."
rm -rf backends/php/vendor backends/php/composer.lock

print_success "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—á–∏—â–µ–Ω—ã"

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º PHP –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
print_warning "–ó–∞–ø—É—Å–∫–∞–µ–º PHP –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏..."
make dev-php

print_success "–ì–æ—Ç–æ–≤–æ! PHP –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"